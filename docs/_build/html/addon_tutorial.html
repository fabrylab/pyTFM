

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Analyzing Force Generation and Stresses in Cell-Colonies with Clickpoints &mdash; pyTFM 1.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using Config Files, Hidden Parameters and Plotting Behavior" href="configuration.html" />
    <link rel="prev" title="Tutorials" href="tutorials.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pyTFM
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to Traction Force Microscopy and Monolayer Stress Microscopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="measures.html">Typical Measures for Force Generation and Stresses in Cells</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Analyzing Force Generation and Stresses in Cell-Colonies with Clickpoints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#about-this-tutorial">About this Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-data">The Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#opening-clickpoints-and-sorting-images">Opening Clickpoints and sorting Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-parameters">Setting Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculating-traction-and-deformation-fields">Calculating Traction and Deformation Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quantifying-force-generation">Quantifying Force Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#measuring-stresses">Measuring Stresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="#measuring-the-line-tension-counting-cells-and-measuring-the-colony-area">Measuring the Line Tension, counting Cells and measuring the Colony Area</a></li>
<li class="toctree-l3"><a class="reference internal" href="#understanding-the-output-file">Understanding the Output File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting-the-results">Plotting the Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Using Config Files, Hidden Parameters and Plotting Behavior</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyTFM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Analyzing Force Generation and Stresses in Cell-Colonies with Clickpoints</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/addon_tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="analyzing-force-generation-and-stresses-in-cell-colonies-with-clickpoints">
<h1>Analyzing Force Generation and Stresses in Cell-Colonies with Clickpoints<a class="headerlink" href="#analyzing-force-generation-and-stresses-in-cell-colonies-with-clickpoints" title="Permalink to this headline">¶</a></h1>
<div class="section" id="about-this-tutorial">
<h2>About this Tutorial<a class="headerlink" href="#about-this-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Using the pyTFM clickpoints addon requires a complete installation of clickpoints.
If you have set up clickpoints correctly, you can open images by right clicking on the image files and select
“open with clickpoints”.</p>
<p>You can find a small example data set, which is used during this tutorial,
<a class="reference external" href="https://github.com/fabrylab/example_data_for_pyTFM/archive/master.zip">here</a>.
The data is in the subfolder “clickpoints_tutorial”.
This data set contains raw data for 2 types of cell colonies: In one group a critical cytoskeletal protein
has been knocked out.
We will compare these cell colonies to a set of wildtype colonies. The raw data, in the form of images,
is contained in the subfolders “WT” and “KO”. All output files, databases and plots as you should produce them
in the course of this tutorial are stored in the folders “KO_analyzed”, “WT_analyzed” and “plots”. Use these folders
to check if your analysis was correct.</p>
</div>
<div class="section" id="the-data">
<h2>The Data<a class="headerlink" href="#the-data" title="Permalink to this headline">¶</a></h2>
<p>As you can see in <a class="reference internal" href="#data"><span class="std std-numref">Fig. 3</span></a>, there are 6 images for each colony type. This corresponds to two field of views
for each wildtype and KO. For each field of view there are 3 images. One image (e.g. 03bf_before.tif) shows the colony
and the boundaries between cells. In this case the image shows fluorescence stained cell membranes.
The other two images show beads that are embedded in the substrate that the cells lie on. One image was recorded before
the cells were removed (03before.tif) and the other was recorded after the cells were removed (03after.tif).
The number in front of the filename (“03”, “10” and so on) indicates which field of view that image belongs to.</p>
<div class="figure align-default" id="data">
<a class="reference internal image-reference" href="_images/data.png"><img alt="Data structure of a Traction Force Microscopy experiment." src="_images/data.png" style="width: 750px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Data structure of a Traction Force Microscopy experiment.</span><a class="headerlink" href="#data" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="opening-clickpoints-and-sorting-images">
<h2>Opening Clickpoints and sorting Images<a class="headerlink" href="#opening-clickpoints-and-sorting-images" title="Permalink to this headline">¶</a></h2>
<p>The first step to analyze the data is to create a clickpoints database, in which the images are identified correctly,
concerning their type (whether it’s an image of the cells or an image of the beads before or after cell removal)
and concerning the field of view they belong to.
<strong>We are going to start with the wildtype data set</strong>. To open a database simple right click on an image and
select “open with” –&gt; “clickpoints”. The option to open with clickpoints might also be visible directly after you right clicked.</p>
<div class="figure align-default" id="open-with-clickpoints">
<a class="reference internal image-reference" href="_images/open_with_clickpoints.png"><img alt="Opening images with clickpoints." src="_images/open_with_clickpoints.png" style="width: 750px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Opening images with clickpoints.</span><a class="headerlink" href="#open-with-clickpoints" title="Permalink to this image">¶</a></p>
</div>
<p>Clickpoints sorts images in two dimensions: Frames and layers. The frames are displayed in the bar at the bottom.
You can skip from frame to frame using the left and right arrows on your keyboard. Layers can be changed
with the “Page Up” and “Page Down” keys. When you open the database, you will notice that there is only one layer
and every image is sorted into a new frame. Our goal is to sort each field of view into one frame, with three layers per
frame, each representing one type of image. In order to do this you need to open the pyTFM addon and open the
“select image” menu. Follow the steps described in <a class="reference internal" href="#open-select-images"><span class="std std-numref">Fig. 5</span></a>.</p>
<div class="figure align-default" id="open-select-images">
<a class="reference internal image-reference" href="_images/open_select_images.png"><img alt="Data structure in the example data set" src="_images/open_select_images.png" style="width: 750px;" /></a>
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">A: Open the addon-browser in clickpoints. A new window, with all available addons will open.
B: Activate the pyTFM addon by selecting pyTFM and clicking the “Activate” button. A window notifying you
that the addon has been loaded successfully will appear. After you press “OK” a new icon
will appear in the clickpoints main window to the right of the addon-browser button. C: Click on this button
to open the pyTFM addon. D: Finally, open the menu to select images by pressing the “select images” button.</span><a class="headerlink" href="#open-select-images" title="Permalink to this image">¶</a></p>
</div>
<p>The “image selection” menu allows you to do three things: You can select where images are
located and how they are classified. You can also set an output folder, where the database file and all analysis
results will be saved and you can choose a name for the database.
As mentioned above, the analysis requires three types of images. For each type you can select a folder
(left hand side) and a regular expression that identifies the image type from the image filename (right hand side).</p>
<p>The default identifiers fit to the example data set, meaning that for now and in the future, if you are using the same
naming scheme for your images, you <strong>can leave the identifiers as they are</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Details on identifying images</strong></p>
<blockquote>
<div><p>The “‘after’ image identifier” identifies images of beads after cell removal, the “‘before’ image identifier”
identifies images of beads before cell removal and the “cell image identifier” identifies images that
show the cells or cell membranes. Finally, there is a separate regular expression, the
“frame identifier” that identifies the field of view each image belongs to. This must point to a
number (e.g. “02” or “2” and so on) in the image filename. This number must be specially marked by brackets “()”.
Note that the extension (“.png”,”.tiff”, “.jpeg” …) must not be included in the identifiers.</p>
<p>Regular expressions are the standard way to find patterns in texts. For example, it allows you to
identify numbers of certain length, groups of characters or the beginning and end of a text. You
find more information on regular expressions <a class="reference external" href="https://docs.python.org/3/library/re.html">here</a>.
Some useful expressions are listed in the table below:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>search pattern</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>after</p></td>
<td><p>all files with “after” in the filename</p></td>
</tr>
<tr class="row-odd"><td><p>^after</p></td>
<td><p>all files with “after” at the beginning of the filename</p></td>
</tr>
<tr class="row-even"><td><p>after$</p></td>
<td><p>all files with “after” at the end of the filename</p></td>
</tr>
<tr class="row-odd"><td><p>*</p></td>
<td><p>all files</p></td>
</tr>
<tr class="row-even"><td><p>^(d{1-4})</p></td>
<td><p>up to 4 numbers at beginning of the filename</p></td>
</tr>
<tr class="row-odd"><td><p>(d{1-4})</p></td>
<td><p>up to 4 consecutive numbers anywhere in the filename</p></td>
</tr>
<tr class="row-even"><td><p>(d{1-4})$</p></td>
<td><p>up to 4 numbers at end of the filename</p></td>
</tr>
</tbody>
</table>
</div>
<p>Once you have entered identifiers for image types, frames, the output folder and the database name press
the “collect images” button. You should see something like this:</p>
<div class="figure align-default" id="output-select-images">
<a class="reference internal image-reference" href="_images/output_select_images.png"><img alt="Output of collect images." src="_images/output_select_images.png" style="width: 750px;" /></a>
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">Output of collect images.</span><a class="headerlink" href="#output-select-images" title="Permalink to this image">¶</a></p>
</div>
<p>Make sure your database didn’t contain any masks that you don’t want to delete. If you just opened the
database from new images, you can press “Yes”. The path to the images that are sorted into the database,
the type of the images (layer) and the field of view of the images (frame) are printed to the console.
Make sure all images are sorted correctly. The program has generated a new clickpoints database file.
Your currently opened clickpoints window updates automatically. You can close the “image selection”
window now.</p>
</div>
<div class="section" id="setting-parameters">
<h2>Setting Parameters<a class="headerlink" href="#setting-parameters" title="Permalink to this headline">¶</a></h2>
<p>Lets continue with calculating the deformation and traction field. Go to the pyTFM addon window
(<a class="reference internal" href="#main"><span class="std std-numref">Fig. 7</span></a>).</p>
<div class="figure align-default" id="main">
<a class="reference internal image-reference" href="_images/main.png"><img alt="Main addon window." src="_images/main.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">Main addon window.</span><a class="headerlink" href="#main" title="Permalink to this image">¶</a></p>
</div>
<p>In this window you have to set the mechanical parameters of the substrate (“Youngs modulus” and “Poisson’s
ratio”), the height of the substrate (“gel height”) and the pixel size (“pixel size”). Then you have to set two more
parameters for the calculation of the deformation field. The deformation field is calculated with particle image
velocimetry. This method essentially cuts out square shaped patches from the image of
the beads before cell removal, places them on the image of beads after cell removal
and checks how well they fit together. The vector form the original position of the patch and the
position where the patch fits best to the image of beads after cell removal is the displacement vector.
This is done for many positions to generate a complete displacement field.</p>
<p>You can control two things: the size of the patch that is cut out of the image of the beads
after cell removal (with the parameter “PIV window size”) and the resolution of the
resulting displacement field (with the parameter “PIV overlapp”). A window size that is to large will blur
the displacement field while a window size that is to small will introduce noise in the displacement field.
As a rule of thumb the window size should be roughly 7 times the bead diameter, you should however try a few
values and check which window size yields a smooth yet accurate deformation field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can measure the beads diameter directly in clickpoints using another addon: The Measure Tool</p>
</div>
<p>The “PIV overlapp” mainly controls the resolution of the resulting displacement field and must be
smaller than the “PIV window size” but at least half of the “PIV window size”. You need
a high resolution for analyzing stress. In this step the area of cells should at least contain 1000
pixels. However, if you are not calculating stresses, you can save a lot of calculation time by choosing a
“PIV overlapp” closer to half of the “PIV window size”. Especially, when you are trying out different window sizes,
you can set the overlap to the smallest allowed value, which is half of the window size.</p>
<p>For this tutorial you can keep all parameters at their default value. If you are in a hurry, you could set the
“PIV window size” to 15 µm.</p>
</div>
<div class="section" id="calculating-traction-and-deformation-fields">
<h2>Calculating Traction and Deformation Fields<a class="headerlink" href="#calculating-traction-and-deformation-fields" title="Permalink to this headline">¶</a></h2>
<p>Once you have set all parameters you can start the calculation: Use the tick boxes in the upper right to select
which part of the analysis you want to perform. For now, we are gonna select only “deformation” and “traction forces”. Then
use the “apply to” option to choose whether all frames should be analyzed or only the frame that you are currently
viewing. Your window should now look like <a class="reference internal" href="#main"><span class="std std-numref">Fig. 7</span></a>. Finally press “start” in the upper left to begin the analysis.
With the default parameters this takes about 5 minutes per frame. “calculation complete” is printed to the console
once all frames have been analyzed.</p>
<p>The traction and deformation fields are added to the database as new layers. Switch to these layers using the “Page Up”
key on your keyboard. Traction and deformation for the first frame in the wildtype data should look like this:</p>
<div class="figure align-default" id="def-trac-res">
<a class="reference internal image-reference" href="_images/def_trac_res.png"><img alt="Deformation and traction fields." src="_images/def_trac_res.png" style="width: 750px;" /></a>
<p class="caption"><span class="caption-number">Fig. 8 </span><span class="caption-text">Deformation and traction fields.</span><a class="headerlink" href="#def-trac-res" title="Permalink to this image">¶</a></p>
</div>
<p>If you do not see the display tool and mask names (“membrane”, “force measures”, “FEM area”) on the right press F2.</p>
</div>
<div class="section" id="quantifying-force-generation">
<h2>Quantifying Force Generation<a class="headerlink" href="#quantifying-force-generation" title="Permalink to this headline">¶</a></h2>
<p>Force generation is quantified with the strain energy and the contractillity. You have to select an area on
which these measures are to be calculated. You can do this by drawing a mask in clickpoints. In the top right
of the clickpoints window you can see a set of tools to draw mask and three preset types of masks. If you
don’t see these tools, press F2.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><strong>Tips for masks in clickpoints.</strong>
Select a mask and use the brush tool <img alt="brush" src="_images/brush.png" /> to draw it. You can
increase and decrease the size of the brush with the “+” and “-” keys. If you want to
erase a part of a mask use the eraser tool <img alt="rubber" src="_images/rubber.png" />. Additionally you can fill holes in your mask with
the bucket tool <img alt="bucket" src="_images/bucket.png" />. Mask types cannot overlap, which means that you erase one mask type when you
paint over it with another type. Sometimes you will have a hard time seeing things are covered with
a mask. Press “i” and “o” to decrease and increase the transparency of the mask.</p>
</div>
<p>The mask type used to calculate strain energy and contractillity is called “force measures”. Select this mask and
draw a circle around all deformations and forces that you think belong to the cell colony. The area you encircle
is typically large than the cell colony itself. You don’t need to fill the area you have encircle. This is done
automatically. However, if you see the “no mask found in frame ..” warning message in the console, you should
first make sure that there is no gap in the circle that you drew. I drew the mask like this:</p>
<div class="figure align-default" id="mask-force-measures">
<a class="reference internal image-reference" href="_images/mask_force_measures.png"><img alt="Mask for quantification of force generation." src="_images/mask_force_measures.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 9 </span><span class="caption-text">Mask for quantification of force generation.</span><a class="headerlink" href="#mask-force-measures" title="Permalink to this image">¶</a></p>
</div>
<p>It’s no big deal if your selection is a bit to big, but you should make sure not to include deformations and
force that do not originate from the cell colony.</p>
<p>You could now press start again, and the program would generate a text file with contractillity and strain energy
for all frames. In order to be a bit more organized and get all results in one text file, we will first prepare
to analyze stresses in the cell sheet at the same time.</p>
</div>
<div class="section" id="measuring-stresses">
<h2>Measuring Stresses<a class="headerlink" href="#measuring-stresses" title="Permalink to this headline">¶</a></h2>
<p>The stress is calculated by modelling the cell colony as a 2 dimensional sheet and applying the traction
forces that we have just calculated to it. Due to inaccuracies in the traction force calculation, namely
that some forces are predicted to originate from outside of the cell sheet, it has proven most accurate to
use an area slightly larger than the cell colony, so that it includes all forces that you think originate form the
cell colony. To select this area, go to the clickpoints main window and switch layers with the “Page Up” or
“Page Down” key until you reach the plot displaying the traction forces. Select the mask “FEM_area” and
encircle all forces originating from the cell colony. I drew the mask like this:</p>
<div class="figure align-default" id="fem-area">
<a class="reference internal image-reference" href="_images/FEM_area.png"><img alt="Mask for the stress calculation with FEM-Method" src="_images/FEM_area.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 10 </span><span class="caption-text">Mask for the stress calculation with the FEM-Method</span><a class="headerlink" href="#fem-area" title="Permalink to this image">¶</a></p>
</div>
<p>Drawing the mask larger than the area where traction forces are present will lead to an underestimation
of stresses, the effect is however quite small for any reasonable mask sizes.</p>
</div>
<div class="section" id="measuring-the-line-tension-counting-cells-and-measuring-the-colony-area">
<h2>Measuring the Line Tension, counting Cells and measuring the Colony Area<a class="headerlink" href="#measuring-the-line-tension-counting-cells-and-measuring-the-colony-area" title="Permalink to this headline">¶</a></h2>
<p>Finally, we want to measure forces that are transmitted across cell-cell boundaries. This requires you
to mark the cell membranes. You will also get the number of cells
in each colony and the area of the cell colony from this selection. Both can be used
to normalize stresses and forces.</p>
<p>In the main window of clickpoints switch to the image showing the cell membrane using the the “Page Up” or
“Page Down” key, select the mask “membrane” and mark all cell membranes.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Press F2 and use the controls (see below) in the bottom right to adjust the contrast of the image.
This might help you to see the membrane staining better.</p>
<p><img alt="control" src="_images/control.png" /></p>
</div>
<p>Use a thin brush and make sure that there are no unintentional gaps. Also mark the outer edge of the colony.
This edges is not included in the calculation of line tensions but is necessary to calculate the correct
area and cell count of the colony. I drew the mask like this:</p>
<div class="figure align-default" id="membrane">
<a class="reference internal image-reference" href="_images/membrane.png"><img alt="Mask of cell membranes." src="_images/membrane.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 11 </span><span class="caption-text">Mask of cell membranes.</span><a class="headerlink" href="#membrane" title="Permalink to this image">¶</a></p>
</div>
<p>Once you have drawn all masks in all frames you are ready to start the calculation. Go to the pyTFM addon window,
tick the check boxes for “stress analysis” and “force generation”, make sure you have set “apply to” to “all
frames”, untick the “deformation” and traction forces” boxes and press start. The calculation should take about 5 minutes.</p>
<p>After the calculation is complete two new plots will be added to the database. The first will show the
mean normal stress in the cell colony and the second will show the line tension along all cell-cell borders.
The outer edge of the cell colony is marked in grey. These lines are not used in the calculation.</p>
<div class="figure align-default" id="stress-res">
<a class="reference internal image-reference" href="_images/stress_res.png"><img alt="Mean normal stress and line tension." src="_images/stress_res.png" style="width: 750px;" /></a>
<p class="caption"><span class="caption-number">Fig. 12 </span><span class="caption-text">Mean normal stress and line tension.</span><a class="headerlink" href="#stress-res" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>A few notes on the calculation of stresses.</strong>
The average stresses (average mean normal and average shear stress) and the coefficient of variation of these
stresses is calculated by averaging over the true area of the cell colony, marked with the mask “membrane”.
The mean normal stress should be high in areas where strong forces oppose each other. This can be seen in
<a class="reference internal" href="#stress-res"><span class="std std-numref">Fig. 12</span></a>. Likewise, the line tension is high if strong forces oppose each other across the line.
A high mean normal stress does not necessarily indicate a high line tension.
It is better to look at the traction forces, when checking if the values for the line tension make sense.</p>
</div>
</div>
<div class="section" id="understanding-the-output-file">
<h2>Understanding the Output File<a class="headerlink" href="#understanding-the-output-file" title="Permalink to this headline">¶</a></h2>
<p>Every time you press start the program creates a text file “out.text” in the output folder.
If such a file already exists, the text file is named out0.txt, out1.txt and so on. The output starts with a
header containing important parameters of the calculation (<a class="reference internal" href="#out"><span class="std std-numref">Fig. 13</span></a>). This is followed by a section containing all
results. Each line has 4 to 6 tab-delimited columns, containing the frame, the id of the object in the frame (if you
analyze multiple cells or cell colonies in this frame), the name of the quantity, the value of the quantity
and optionally the unit of the quantity and a warning.</p>
<div class="figure align-default" id="out">
<a class="reference internal image-reference" href="_images/out.png"><img alt="The output file." src="_images/out.png" style="width: 750px;" /></a>
<p class="caption"><span class="caption-number">Fig. 13 </span><span class="caption-text">The output file.</span><a class="headerlink" href="#out" title="Permalink to this image">¶</a></p>
</div>
<p>Warnings such as “mask was cut close to image edge” and “small FEM grid” should not be ignored.</p>
</div>
<div class="section" id="plotting-the-results">
<h2>Plotting the Results<a class="headerlink" href="#plotting-the-results" title="Permalink to this headline">¶</a></h2>
<p>Repeat the same analysis for the KO data set. Once you have the output text files for both data sets you could go
ahead and use any tool of your choosing to read the files and plot the important quantities. Of course the best
tool to do so is python, where pyTFM provides specialized functions to read and plot data.</p>
<p>First lets import all functions that we need:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyTFM.data_analysis</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>Next we read the output files from wildtype and KO data sets. This is done in two steps: First the
text files are read into a dictionary where they are sorted for the frames, object ids and the type
of the quantity. Then this dictionary is reduced to a dictionary where each key is the name of a
quantity and the value is a list of the measured values.
Note that our output text file for the last step should be called “out0.txt” if you followed the tutorial
exactely.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># reading the Wildtype data set. Use your own output text file here</span>
<span class="n">file_WT</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/home/user/Software/pyTFM/example_analysis/WT/out0.txt&quot;</span>
<span class="c1"># reading the parameters and the results, sorted for frames and object ids</span>
<span class="n">parameter_dict_WT</span><span class="p">,</span><span class="n">res_dict_WT</span> <span class="o">=</span> <span class="n">read_output_file</span><span class="p">(</span><span class="n">file_WT</span><span class="p">)</span>
<span class="c1"># pooling all frames together.</span>
<span class="n">n_frames_WT</span><span class="p">,</span><span class="n">values_dict_WT</span><span class="p">,</span> <span class="n">frame_list_WT</span> <span class="o">=</span> <span class="n">prepare_values</span><span class="p">(</span><span class="n">res_dict_WT</span><span class="p">)</span>
<span class="c1"># reading the KO data set. Use your own output text file here</span>
<span class="n">file_KO</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/home/user/Software/pyTFM/example_analysis/KO/out0.txt&quot;</span>
<span class="n">parameter_dict_KO</span><span class="p">,</span><span class="n">res_dict_KO</span><span class="o">=</span><span class="n">read_output_file</span><span class="p">(</span><span class="n">file_KO</span><span class="p">)</span>
<span class="n">n_frames_KO</span><span class="p">,</span><span class="n">values_dict_KO</span><span class="p">,</span> <span class="n">frame_list_KO</span><span class="o">=</span><span class="n">prepare_values</span><span class="p">(</span><span class="n">res_dict_KO</span><span class="p">)</span>
</pre></div>
</div>
<p>We are going to use the dictionaries with pooled values (values_dict_WT and values_dict_KO) for plotting.
First let’s do some normalization: We can guess that a larger colony generates more forces. If we assume
the relation is somewhat linear it is useful to normalize measures of the force generation with
the area of the colony:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># normalizing the strain energy</span>
<span class="n">values_dict_WT</span><span class="p">[</span><span class="s2">&quot;strain energy per area&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_dict_WT</span><span class="p">[</span><span class="s2">&quot;strain energy on colony&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">values_dict_WT</span><span class="p">[</span><span class="s2">&quot;area of colony&quot;</span><span class="p">]</span>
<span class="n">values_dict_KO</span><span class="p">[</span><span class="s2">&quot;strain energy per area&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_dict_KO</span><span class="p">[</span><span class="s2">&quot;strain energy on colony&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">values_dict_WT</span><span class="p">[</span><span class="s2">&quot;area of colony&quot;</span><span class="p">]</span>
<span class="c1"># normalizing the contractillity</span>
<span class="n">values_dict_WT</span><span class="p">[</span><span class="s2">&quot;contractillity per area&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_dict_WT</span><span class="p">[</span><span class="s2">&quot;contractillity on colony&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">values_dict_WT</span><span class="p">[</span><span class="s2">&quot;area of colony&quot;</span><span class="p">]</span>
<span class="n">values_dict_KO</span><span class="p">[</span><span class="s2">&quot;contractillity per area&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_dict_KO</span><span class="p">[</span><span class="s2">&quot;contractillity on colony&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">values_dict_WT</span><span class="p">[</span><span class="s2">&quot;area of colony&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that this only works if force generation and area were calculated successfully for all colonies.</p>
<p>Now we can perform a t-test to check if there are any significant differences between KO and WT. We will do
this for all value pairs at once and later display only the most important ones value pairs.
Unfortunately, due to the the fact that we analyzed only two colonies
per data set you will find no significant diffrence in this case.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># t-test for all value pairs</span>
<span class="n">t_test_dict</span> <span class="o">=</span> <span class="n">t_test</span><span class="p">(</span><span class="n">values_dict_WT</span><span class="p">,</span><span class="n">values_dict_KO</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s produce some plots. First, we are going to compare some key measures with box plots. The function
“box_plots” expects two dictionaries with values, a list (“labels”) with two elements, which identifies
these dictionary and a list (“types”) of measures that you want to plot. Additionally you can provide
a dictionary containing statistical test results and specify your own axis labels and axis limits:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;WT&quot;</span><span class="p">,</span> <span class="s2">&quot;KO&quot;</span><span class="p">]</span> <span class="c1"># designations for the two dictionaries that are provided to the box_plots functions</span>
<span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;contractillity per area&quot;</span><span class="p">,</span> <span class="s2">&quot;strain energy per area&quot;</span><span class="p">]</span> <span class="c1"># name of the measures that are plotted</span>
<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;contractillity per colony area [N/m²]&quot;</span><span class="p">,</span> <span class="s2">&quot;strain energy per colony area [J/m²]&quot;</span><span class="p">]</span> <span class="c1"># custom axes labels</span>
<span class="c1"># producing a two box plots comparing the strain energy and the contractillity in WT and KO</span>
<span class="n">fig_force</span> <span class="o">=</span> <span class="n">box_plots</span><span class="p">(</span><span class="n">values_dict_WT</span><span class="p">,</span> <span class="n">values_dict_KO</span><span class="p">,</span> <span class="n">lables</span><span class="p">,</span> <span class="n">t_test_dict</span><span class="o">=</span><span class="n">t_test_dict</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="n">types</span><span class="p">,</span>
           <span class="n">low_ylim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ylabels</span><span class="o">=</span><span class="n">ylabels</span><span class="p">,</span> <span class="n">plot_legend</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>We can do the same for the mean normal stress and line tension:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;WT&quot;</span><span class="p">,</span> <span class="s2">&quot;KO&quot;</span><span class="p">]</span> <span class="c1"># designations for the two dictionaries that are provided to the box_plots functions</span>
<span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mean normal stress on colony&quot;</span><span class="p">,</span> <span class="s2">&quot;average magnitude line tension&quot;</span><span class="p">]</span> <span class="c1"># name of the measures that are plotted</span>
<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mean normal stress [N/m]&quot;</span><span class="p">,</span> <span class="s2">&quot;line tension [N/m]&quot;</span><span class="p">]</span> <span class="c1">#</span>
<span class="n">fig_stress</span> <span class="o">=</span> <span class="n">box_plots</span><span class="p">(</span><span class="n">values_dict_WT</span><span class="p">,</span> <span class="n">values_dict_KO</span><span class="p">,</span> <span class="n">lables</span><span class="p">,</span> <span class="n">t_test_dict</span><span class="o">=</span><span class="n">t_test_dict</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="n">types</span><span class="p">,</span>
          <span class="n">low_ylim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ylabels</span><span class="o">=</span><span class="n">ylabels</span><span class="p">,</span> <span class="n">plot_legend</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Another interesting way of studying force generation is to look at the relation between strain energy (beeing
a measure for total force generation) and contractillity (beeing a measure for the coordinated force generation)
This can be done as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;WT&quot;</span><span class="p">,</span> <span class="s2">&quot;KO&quot;</span><span class="p">]</span> <span class="c1"># designations for the two dictionaries that are provided to the box_plots functions</span>
<span class="c1"># name of the measures that are plotted. Must be length 2 for this case.</span>
<span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;contractillity per area&quot;</span><span class="p">,</span> <span class="s2">&quot;strain energy per area&quot;</span><span class="p">]</span>
<span class="c1"># plotting value of types[0] vs value of types[1]</span>
<span class="n">fig_force2</span> <span class="o">=</span> <span class="n">compare_two_values</span><span class="p">(</span><span class="n">values_dict_WT</span><span class="p">,</span> <span class="n">values_dict_KO</span><span class="p">,</span> <span class="n">types</span><span class="p">,</span> <span class="n">lables</span><span class="p">,</span>
         <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;contractillity per colony area [N/m²]&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;strain energy per colony area [J/m²]&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, let’s save the figures.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># define and output folder for your figures</span>
<span class="n">folder_plots</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/home/user/Software/pyTFM/example_analysis/plots/&quot;</span>
<span class="c1"># create the folder, if it doesn&#39;t already exist</span>
<span class="n">createFolder</span><span class="p">(</span><span class="n">folder_plots</span><span class="p">)</span>
<span class="c1"># saving the three figures that were created beforehand</span>
<span class="n">fig_force</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_plots</span><span class="p">,</span> <span class="s2">&quot;forces1.png&quot;</span><span class="p">))</span> <span class="c1"># boxplot comparing measures for force generation</span>
<span class="n">fig_stress</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_plots</span><span class="p">,</span> <span class="s2">&quot;fig_stress.png&quot;</span><span class="p">))</span> <span class="c1"># boxplot comapring normal stress and line tension</span>
<span class="n">fig_force2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_plots</span><span class="p">,</span> <span class="s2">&quot;forces2.png&quot;</span><span class="p">))</span> <span class="c1"># plot of strain energy vs contractillity</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="configuration.html" class="btn btn-neutral float-right" title="Using Config Files, Hidden Parameters and Plotting Behavior" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorials.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Andreas Bauer

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>